\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { motion } from \"framer-motion\";\nimport { CheckIcon, StarIcon, RocketIcon, LightningBoltIcon } from \"@radix-ui/react-icons\";\nimport { Card3D } from \"@/components/premium/Card3D\";\nimport { FadeUpOnScroll, GradientText } from \"@/components/premium/AnimatedText\";\nimport { GradientBg } from \"@/components/premium/GradientBg\";\nimport Link from \"next/link\";\nimport { useState } from \"react\";\nimport { getStripe } from \"@/lib/stripe/client\";\nimport { STRIPE_PLANS } from \"@/lib/stripe/config\";\n\nexport default function Pricing() {\n  const [loadingPlanId, setLoadingPlanId] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const plans = [\n    STRIPE_PLANS.FREE,\n    STRIPE_PLANS.FUNDRAISING,\n    STRIPE_PLANS.VENTURE_STUDIO,\n  ];\n\n  const handleCheckout = async (plan: typeof plans[0]) => {\n    try {\n      setError(null);\n      setLoadingPlanId(plan.id);\n\n      if (plan.id === \"free\") {\n        window.location.href = \"/get-started\";\n        return;\n      }\n\n      const userId = \"user_\" + Math.random().toString(36).substr(2, 9);\n      const email = prompt(\"Enter your email:\") || \"\";\n\n      if (!email) {\n        setError(\"Email is required\");\n        setLoadingPlanId(null);\n        return;\n      }\n\n      const response = await fetch(\"/api/stripe/checkout\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          priceId: plan.priceId,\n          userId,\n          email,\n          successUrl: `${window.location.origin}/billing?success=true`,\n          cancelUrl: `${window.location.origin}/pricing`,\n        }),\n      });\n\n      if (!response.ok) {\n        const data = (await response.json()) as { error: string };\n        throw new Error(data.error || \"Failed to create checkout session\");\n      }\n\n      const { url } = (await response.json()) as { url: string };\n\n      if (url) {\n        window.location.href = url;\n      }\n    } catch (err) {\n      console.error(\"Checkout error:\", err);\n      setError(\n        err instanceof Error ? err.message : \"Failed to start checkout\"\n      );\n      setLoadingPlanId(null);\n    }\n  };\n\n  return (\n    <section id=\"pricing\" className=\"relative w-full overflow-hidden py-24\">\n      <div className=\"absolute inset-0 -z-10\">\n        <GradientBg variant=\"radial\" className=\"opacity-40\" />\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 md:px-8\">\n        <FadeUpOnScroll className=\"text-center mb-16\">\n          <motion.span className=\"inline-block text-sm font-medium text-primary bg-primary/10 px-4 py-1.5 rounded-full mb-4\">\n            PRICING\n          </motion.span>\n          <h2 className=\"text-3xl md:text-4xl lg:text-5xl font-bold mb-4\">\n            Simple, <GradientText>Transparent</GradientText> Pricing\n          </h2>\n          <p className=\"mx-auto max-w-2xl text-lg text-muted-foreground\">\n            Each tier unlocks outcomes, not just features. Higher tiers reduce\n            time-to-clarity and time-to-conviction.\n          </p>\n        </FadeUpOnScroll>\n\n        {error && (\n          <div className=\"mb-8 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-center text-red-600\">\n            {error}\n          </div>\n        )}\n\n        <div className=\"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto\">\n          {plans.map((plan, index) => {\n            const isMostPopular = plan.id === \"fundraising\";\n            const gradient =\n              plan.id === \"free\"\n                ? \"from-gray-500 to-gray-600\"\n                : plan.id === \"fundraising\"\n                  ? \"from-primary to-blue-500\"\n                  : \"from-purple-500 to-pink-500\";\n            const icon =\n              plan.id === \"free\" ? (\n                <LightningBoltIcon className=\"h-6 w-6 text-white\" />\n              ) : plan.id === \"fundraising\" ? (\n                <StarIcon className=\"h-6 w-6 text-white\" />\n              ) : (\n                <RocketIcon className=\"h-6 w-6 text-white\" />\n              );\n\n            return (\n              <FadeUpOnScroll key={plan.id} delay={index * 0.15}>\n                <Card3D\n                  rotationIntensity={isMostPopular ? 6 : 8}\n                  className={`relative h-full rounded-2xl overflow-hidden ${\n                    isMostPopular\n                      ? \"bg-gradient-to-b from-primary/10 to-card border-2 border-primary shadow-xl shadow-primary/20\"\n                      : \"bg-card/90 backdrop-blur-sm border border-border/50\"\n                  }`}\n                >\n                  {isMostPopular && (\n                    <div className=\"absolute -top-px left-0 right-0 h-1 bg-gradient-to-r from-primary via-blue-500 to-primary\" />\n                  )}\n\n                  <div className=\"relative z-10 p-8\">\n                    {isMostPopular && (\n                      <motion.div\n                        initial={{ y: -10, opacity: 0 }}\n                        animate={{ y: 0, opacity: 1 }}\n                        className=\"absolute -top-4 left-1/2 -translate-x-1/2\"\n                      >\n                        <span className=\"bg-primary text-primary-foreground px-4 py-1.5 rounded-full text-sm font-medium shadow-lg\">\n                          Most Popular\n                        </span>\n                      </motion.div>\n                    )}\n\n                    <div className={`w-12 h-12 rounded-xl bg-gradient-to-br ${gradient} flex items-center justify-center mb-6 shadow-lg`}>\n                      {icon}\n                    </div>\n\n                    <div className=\"mb-6\">\n                      <h3 className=\"text-xl font-bold mb-2\">{plan.name}</h3>\n                      <p className=\"text-muted-foreground text-sm\">\n                        {plan.id === \"free\"\n                          ? \"Free forever build trust and habit\"\n                          : plan.id === \"fundraising\"\n                            ? \"Turn clarity into investor-grade readiness\"\n                            : \"Leverage, execution & capital connectivity\"}\n                      </p>\n                    </div>\n\n                    <div className=\"flex items-baseline mb-6\">\n                      <span className=\"text-5xl font-bold\">${plan.price}</span>\n                      {plan.price > 0 && (\n                        <span className=\"text-muted-foreground ml-2\">/month</span>\n                      )}\n                    </div>\n\n                    <Button\n                      onClick={() => handleCheckout(plan)}\n                      disabled={loadingPlanId === plan.id}\n                      className={`w-full mb-6 ${\n                        isMostPopular\n                          ? \"shadow-lg shadow-primary/25 hover:shadow-primary/40\"\n                          : \"\"\n                      }`}\n                      variant={isMostPopular ? \"default\" : \"outline\"}\n                      size=\"lg\"\n                    >\n                      {loadingPlanId === plan.id ? (\n                        <>\n                          <span className=\"inline-block animate-spin mr-2\">L</span>\n                          Loading...\n                        </>\n                      ) : plan.price === 0 ? (\n                        \"Get Started Free\"\n                      ) : (\n                        \"Start 14-Day Trial\"\n                      )}\n                    </Button>\n\n                    <Separator className=\"my-6\" />\n\n                    <ul className=\"space-y-4\">\n                      {plan.features.map((feature, featureIndex) => (\n                        <motion.li\n                          key={featureIndex}\n                          initial={{ opacity: 0, x: -10 }}\n                          whileInView={{ opacity: 1, x: 0 }}\n                          viewport={{ once: true }}\n                          transition={{ delay: 0.3 + featureIndex * 0.05 }}\n                          className=\"flex items-start gap-3 text-sm\"\n                        >\n                          <div className=\"mt-0.5 p-0.5 rounded-full bg-green-500/20\">\n                            <CheckIcon className=\"h-3 w-3 text-green-500\" />\n                          </div>\n                          <span className=\"text-muted-foreground\">{feature}</span>\n                        </motion.li>\n                      ))}\n                    </ul>\n                  </div>\n\n                  <div className={`absolute bottom-0 left-0 right-0 h-40 bg-gradient-to-t ${gradient} opacity-5 pointer-events-none`} />\n                </Card3D>\n              </FadeUpOnScroll>\n            );\n          })}\n        </div>\n\n        <FadeUpOnScroll delay={0.5} className=\"text-center mt-12\">\n          <p className=\"text-sm text-muted-foreground\">\n            All plans include a 14-day free trial. No credit card required.\n          </p>\n        </FadeUpOnScroll>\n      </div>\n    </section>\n  );\n}\n