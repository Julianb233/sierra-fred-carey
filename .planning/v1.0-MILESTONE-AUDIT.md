---
milestone: v1.0
audited: 2026-02-05
status: gaps_found
scores:
  requirements: 11/17
  phases: 3/4
  integration: 5/9
  flows: 1/3
gaps:
  requirements:
    - id: STRAT-COMPONENTS
      description: "Strategy document UI components incomplete"
      severity: blocker
      phase: "03-pro-tier"
      missing:
        - "components/strategy/document-preview.tsx"
        - "components/strategy/document-list.tsx"
        - "components/strategy/index.ts"
    - id: PHASE-04
      description: "Studio Tier not implemented"
      severity: blocker
      phase: "04-studio-tier"
      missing:
        - "Virtual agent architecture and implementation"
        - "Twilio SMS weekly check-ins"
        - "Boardy integration"
        - "Studio tier Stripe integration"
    - id: TIER-DISPLAY
      description: "Client-side tier detection always shows FREE"
      severity: blocker
      phase: "02-free-tier"
      missing:
        - "TierProvider not mounted in providers.tsx"
        - "/api/user/subscription response shape mismatch with tier-context.tsx consumer"
        - "Dashboard layout hardcodes tier: 0"
    - id: REALITY-LENS-WIRING
      description: "Dashboard Reality Lens calls legacy API instead of Phase 02 engine"
      severity: blocker
      phase: "02-free-tier"
      missing:
        - "Dashboard page calls /api/reality-lens (legacy) not /api/fred/reality-lens (FRED)"
    - id: ONBOARD-AUTH
      description: "Get-started signup assigns random password user never sees"
      severity: blocker
      phase: "02-free-tier"
      missing:
        - "User never receives generated password"
        - "Cannot log back in after session expires"
    - id: SUPABASE-AUTH
      description: "Supabase user creation returns 500 Database error"
      severity: blocker
      phase: "02-free-tier"
      missing:
        - "Supabase schema/migrations need to be fixed for user creation"
  integration:
    - from: "02-free-tier"
      to: "03-pro-tier"
      connection: "Client-side tier display"
      reason: "TierProvider not mounted, response shape mismatch, hardcoded tier=0 in layout"
    - from: "03-pro-tier"
      to: "03-pro-tier"
      connection: "Stripe payment → tier update in UI"
      reason: "Webhook writes user_subscriptions but dashboard reads profiles.tier"
    - from: "02-free-tier"
      to: "02-free-tier"
      connection: "Reality Lens engine → dashboard UI"
      reason: "Dashboard calls legacy /api/reality-lens instead of /api/fred/reality-lens"
    - from: "02-free-tier"
      to: "dashboard-nav"
      connection: "Decision History in dashboard navigation"
      reason: "No sidebar link to /dashboard/history"
    - from: "03-pro-tier"
      to: "dashboard-nav"
      connection: "Investor Readiness in dashboard navigation"
      reason: "Sidebar links to /dashboard/investor-score not /dashboard/investor-readiness"
  flows:
    - name: "User signs up → onboarding → dashboard"
      broken_at: "Password generation"
      reason: "Random password generated but never shown to user"
    - name: "Free user → Stripe upgrade → Pro access"
      broken_at: "Post-payment tier display"
      reason: "Webhook updates user_subscriptions but UI reads wrong table/field; TierProvider not mounted"
tech_debt:
  - phase: "02-free-tier"
    items:
      - "Dual auth import pattern: @/lib/auth vs @/lib/supabase/auth-helpers"
      - "Legacy /api/reality-lens route still active alongside /api/fred/reality-lens"
  - phase: "03-pro-tier"
    items:
      - "Strategy generator.ts exists but strategy dashboard page is incomplete"
      - "Pitch review gap closure plan (03-06) was executed but needs verification"
      - "Strategy gap closure plan (03-07) was partially executed - missing UI components"
  - phase: "general"
    items:
      - "Dashboard layout uses hardcoded mock user data"
      - "Multiple get-started vs onboarding flows (/get-started vs /onboarding) with different implementations"
---

# v1.0 Milestone Audit

**Project:** Sahara - AI-Powered Founder Operating System
**Milestone:** v1.0 MVP
**Audited:** 2026-02-05
**Status:** GAPS FOUND

---

## Scores

| Area | Score | Status |
|------|-------|--------|
| Requirements | 11/17 | 6 blockers |
| Phases | 3/4 complete | Phase 04 not started |
| Integration | 5/9 connections | 4 broken |
| E2E Flows | 1/3 complete | 2 broken |

---

## Phase Status

### Phase 01: FRED Cognitive Engine Foundation - COMPLETE
- XState v5 state machine
- 7-factor scoring engine
- Memory persistence (episodic, semantic, procedural)
- Circuit breaker + multi-provider reliability
- FRED API endpoints

### Phase 02: Free Tier Features - COMPLETE (integration issues)
- Reality Lens engine exists but dashboard calls legacy API
- FRED Chat with streaming - functional
- Decision History - functional but not linked in nav
- Tier gating - server-side works, client-side broken
- Onboarding - exists but auth flow has password gap

### Phase 03: Pro Tier Features - MOSTLY COMPLETE
- PDF document pipeline - complete
- Investor Readiness Score - complete (not linked in nav)
- Pitch Deck Review - code exists (gap closure 03-06 executed)
- Strategy Documents - partially complete (missing 3 UI components)
- Stripe integration - backend complete, frontend wiring broken

### Phase 04: Studio Tier - NOT STARTED
- No virtual agent architecture
- No Twilio SMS integration
- No Boardy integration
- No Studio tier Stripe flow

---

## Critical Issues (P0)

### 1. Client-Side Tier Detection Always Returns FREE
**Impact:** Users who pay via Stripe will not see their tier reflected in the UI

Three independent breaks:
1. `TierProvider` never mounted in `app/providers.tsx`
2. `/api/user/subscription` returns `{plan: {id}, subscription: {status}}` but `tier-context.tsx` expects `{planId, subscriptionStatus}`
3. `app/dashboard/layout.tsx` hardcodes `user.tier = 0`

### 2. Onboarding Password Gap
**Impact:** Users who sign up via get-started flow cannot log back in

`/api/onboard` generates random UUID password via `crypto.randomUUID()` that the user never sees. After session expires, they're locked out.

### 3. Supabase User Creation 500 Error
**Impact:** No users can be created, blocking all authenticated features

Database error on `auth.users` table prevents signups via both admin and public API.

### 4. Stripe Payment → Tier Update Broken
**Impact:** Revenue-critical flow fails

Webhook writes to `user_subscriptions` table but dashboard reads from `profiles.tier` (may not exist). Even if it did, the TierProvider (Issue 1) would override with FREE.

---

## Integration Issues (P1)

### 5. Reality Lens Engine Orphaned
Dashboard page `/dashboard/reality-lens` calls legacy `/api/reality-lens` instead of the Phase 02 FRED-powered `/api/fred/reality-lens`. The entire `lib/fred/reality-lens.ts` engine is unused.

### 6. Dashboard Navigation Missing Pages
- No sidebar link to `/dashboard/history` (Decision History)
- Sidebar links to `/dashboard/investor-score` instead of `/dashboard/investor-readiness` (IRS)

### 7. Strategy UI Components Incomplete
Missing: `document-preview.tsx`, `document-list.tsx`, `index.ts` in `components/strategy/`. Generator and templates exist but the dashboard page is incomplete.

---

## Requirements Coverage

| Requirement | Status | Phase | Notes |
|-------------|--------|-------|-------|
| FRED cognitive engine | Satisfied | 01 | State machine, scoring, memory all working |
| Multi-provider AI | Satisfied | 01 | Circuit breaker + fallback chain |
| Reality Lens | Partial | 02 | Engine exists but dashboard calls legacy API |
| FRED chat | Satisfied | 02 | Streaming, cognitive state, confidence badges |
| Decision history | Partial | 02 | Works but not linked in dashboard nav |
| Tier gating | Partial | 02 | Server-side works, client-side broken |
| Onboarding | Partial | 02 | Flow works but auth has password gap |
| PDF pipeline | Satisfied | 03 | Upload, extract, chunk, embed |
| Investor Readiness Score | Satisfied | 03 | Engine + API + UI complete |
| Pitch Deck Review | Satisfied | 03 | Gap closure 03-06 executed, code exists |
| Strategy Documents | Partial | 03 | Backend complete, 3 UI components missing |
| Stripe Pro tier | Partial | 03 | Backend works, frontend tier update broken |
| Virtual Agents | Not Started | 04 | Zero code |
| SMS Check-ins | Not Started | 04 | Zero code |
| Boardy Integration | Not Started | 04 | Zero code |
| Studio Stripe tier | Not Started | 04 | Zero code |
| Auth system | Broken | infra | Supabase 500 on user creation |

---

## E2E Flow Analysis

### Flow 1: Signup → Chat with FRED (BROKEN)
1. `/get-started` page → 2. Submit email → 3. `/api/onboard` creates user with random password → 4. Redirect to dashboard → **5. BREAK: password never shown, session may not persist**

### Flow 2: Free → Stripe Upgrade → Pro Access (BROKEN)
1. See locked features → 2. Click upgrade → 3. Stripe checkout → 4. Payment succeeds → 5. Webhook updates `user_subscriptions` → **6. BREAK: UI still shows FREE** (TierProvider not mounted + response shape mismatch + hardcoded tier=0)

### Flow 3: Chat → View History → Continue (FUNCTIONAL with navigation gap)
1. Chat with FRED → 2. Messages stored in `fred_episodic_memory` → 3. Navigate to `/dashboard/history` (no nav link) → 4. See session list → 5. Click session → 6. View conversation → 7. Click "Continue" → 8. Returns to `/chat` with context

---

## Tech Debt

- Dual auth import pattern (`@/lib/auth` vs `@/lib/supabase/auth-helpers`)
- Legacy `/api/reality-lens` route active alongside `/api/fred/reality-lens`
- Dashboard layout uses hardcoded mock user data
- Two separate onboarding flows (`/get-started` vs `/onboarding`) with different implementations
- Pitch review gap closure needs verification
- Strategy gap closure partially complete

---

*Audit generated: 2026-02-05*
*Integration checker: gsd-integration-checker agent*
