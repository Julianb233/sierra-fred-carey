---
phase: 03-pro-tier
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/db/migrations/026_pitch_reviews.sql
  - lib/fred/pitch/types.ts
  - lib/fred/pitch/slide-classifier.ts
  - lib/fred/pitch/analyzers/index.ts
  - lib/fred/pitch/review-engine.ts
  - lib/fred/pitch/db.ts
  - lib/fred/pitch/index.ts
  - app/api/fred/pitch-review/route.ts
  - components/pitch/review-summary.tsx
  - components/pitch/deck-overview.tsx
  - components/pitch/slide-analysis-panel.tsx
  - components/pitch/index.ts
  - app/dashboard/pitch-deck/page.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Slide classifier identifies 12 slide types from extracted PDF page text"
    - "Per-slide analyzers evaluate content quality with type-specific criteria"
    - "Review engine produces overall, structure, and content scores"
    - "POST /api/fred/pitch-review accepts documentId, requires Pro tier, returns full review"
    - "Dashboard page at /dashboard/pitch-deck displays real AI-generated slide-by-slide analysis"
  artifacts:
    - path: "lib/fred/pitch/types.ts"
      provides: "SlideType union, SlideClassification, SlideAnalysis, PitchReview interfaces"
      exports: ["SlideType", "SLIDE_TYPES", "REQUIRED_SLIDES", "SlideClassification", "SlideAnalysis", "PitchReview", "PitchReviewInput", "DeckStructure"]
    - path: "lib/fred/pitch/slide-classifier.ts"
      provides: "AI-powered slide classification using generateObject + Zod"
      exports: ["classifySlide", "classifyDeck"]
    - path: "lib/fred/pitch/analyzers/index.ts"
      provides: "Per-slide-type analysis with type-specific criteria prompts"
      exports: ["analyzeSlide"]
    - path: "lib/fred/pitch/review-engine.ts"
      provides: "Orchestrates classification, analysis, scoring into full PitchReview"
      exports: ["reviewPitchDeck"]
    - path: "lib/fred/pitch/db.ts"
      provides: "CRUD for pitch_reviews table via Supabase"
      exports: ["savePitchReview", "getPitchReview", "getPitchReviews", "getPitchReviewByDocument"]
    - path: "lib/fred/pitch/index.ts"
      provides: "Barrel re-export for pitch module"
    - path: "app/api/fred/pitch-review/route.ts"
      provides: "POST and GET endpoints for pitch review"
      exports: ["POST", "GET"]
    - path: "app/dashboard/pitch-deck/page.tsx"
      provides: "Functional pitch review page replacing static mock"
    - path: "components/pitch/review-summary.tsx"
      provides: "Overall scores and strengths/improvements display"
    - path: "components/pitch/deck-overview.tsx"
      provides: "Grid of slides with color-coded scores and click-to-select"
    - path: "components/pitch/slide-analysis-panel.tsx"
      provides: "Detailed per-slide feedback panel"
    - path: "lib/db/migrations/026_pitch_reviews.sql"
      provides: "Database table for pitch review results"
      contains: "CREATE TABLE"
  key_links:
    - from: "lib/fred/pitch/review-engine.ts"
      to: "lib/fred/pitch/slide-classifier.ts"
      via: "classifyDeck called inside reviewPitchDeck"
      pattern: "classifyDeck"
    - from: "lib/fred/pitch/review-engine.ts"
      to: "lib/fred/pitch/analyzers/index.ts"
      via: "analyzeSlide called per classified slide"
      pattern: "analyzeSlide"
    - from: "app/api/fred/pitch-review/route.ts"
      to: "lib/fred/pitch/review-engine.ts"
      via: "POST handler calls reviewPitchDeck"
      pattern: "reviewPitchDeck"
    - from: "app/api/fred/pitch-review/route.ts"
      to: "lib/api/tier-middleware.ts"
      via: "checkTierForRequest(request, UserTier.PRO)"
      pattern: "checkTierForRequest"
    - from: "app/api/fred/pitch-review/route.ts"
      to: "lib/db/documents.ts"
      via: "getDocumentById + getDocumentChunks to load PDF pages"
      pattern: "getDocumentById|getDocumentChunks"
    - from: "app/dashboard/pitch-deck/page.tsx"
      to: "/api/fred/pitch-review"
      via: "fetch POST to trigger review, GET to load results"
      pattern: "fetch.*pitch-review"
---

<objective>
Build the complete Pitch Deck Review feature, closing UAT gaps 1 (Test 6) and 2 (Test 7).

Purpose: Pro tier users can select an uploaded pitch deck (from existing PDF pipeline) and receive AI-powered slide-by-slide analysis with scoring. Plans 03-03 was marked complete but zero code exists -- this is a full implementation from scratch.

Output: Working pitch review engine (lib/fred/pitch/), API endpoint (POST/GET /api/fred/pitch-review), database table (pitch_reviews), and functional dashboard page replacing the existing static mock at /dashboard/pitch-deck.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-pro-tier/03-UAT.md

Existing patterns to follow (read these files for exact code patterns):
@lib/fred/irs/types.ts — Type definitions with const arrays and Record maps
@lib/fred/irs/engine.ts — Engine using generateObject() from 'ai' + openai('gpt-4o') + Zod schemas
@lib/fred/irs/db.ts — Supabase client init, CRUD ops, mapDbToResult pattern
@lib/fred/irs/index.ts — Barrel re-exports
@app/api/fred/investor-readiness/route.ts — API route with checkTierForRequest(req, UserTier.PRO), POST/GET handlers
@lib/api/tier-middleware.ts — checkTierForRequest, UserTier import from @/lib/constants
@lib/db/documents.ts — getDocumentById(userId, docId), getDocumentChunks(docId) functions
@lib/documents/types.ts — ExtractedPage type {pageNumber, content, charCount}
@lib/documents/pdf-processor.ts — extractText returns {text, pages, metadata, pageCount}
@lib/db/migrations/025_investor_readiness_scores.sql — Migration pattern
@components/irs/score-gauge.tsx — Reusable ScoreGauge component (reuse for pitch scores)
@app/dashboard/investor-readiness/page.tsx — Dashboard page pattern (loading/error/result states, layout)
@app/dashboard/pitch-deck/page.tsx — EXISTING STATIC MOCK to replace
@lib/constants.ts — UserTier enum, brand colors
</context>

<tasks>

<task type="auto">
  <name>Task 1: Pitch Review Engine -- Types, Classifier, Analyzers, Engine, DB, Migration</name>
  <files>
    lib/db/migrations/026_pitch_reviews.sql
    lib/fred/pitch/types.ts
    lib/fred/pitch/slide-classifier.ts
    lib/fred/pitch/analyzers/index.ts
    lib/fred/pitch/review-engine.ts
    lib/fred/pitch/db.ts
    lib/fred/pitch/index.ts
  </files>
  <action>
    Create the entire lib/fred/pitch/ module following the exact structural pattern of lib/fred/irs/.

    **1. Migration: lib/db/migrations/026_pitch_reviews.sql**
    Follow the 025_investor_readiness_scores.sql pattern exactly:
    ```sql
    CREATE TABLE IF NOT EXISTS pitch_reviews (
      id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
      user_id UUID NOT NULL,
      document_id UUID NOT NULL,
      overall_score DECIMAL(5,2) NOT NULL,
      structure_score DECIMAL(5,2) NOT NULL,
      content_score DECIMAL(5,2) NOT NULL,
      slides JSONB NOT NULL,
      missing_sections TEXT[] DEFAULT '{}',
      strengths TEXT[] DEFAULT '{}',
      improvements TEXT[] DEFAULT '{}',
      metadata JSONB DEFAULT '{}',
      created_at TIMESTAMPTZ DEFAULT NOW()
    );
    CREATE INDEX IF NOT EXISTS idx_pitch_reviews_user ON pitch_reviews(user_id);
    CREATE INDEX IF NOT EXISTS idx_pitch_reviews_document ON pitch_reviews(document_id);
    CREATE INDEX IF NOT EXISTS idx_pitch_reviews_created ON pitch_reviews(created_at DESC);
    ```

    **2. Types: lib/fred/pitch/types.ts**
    Mirror the structure of lib/fred/irs/types.ts. Define:

    ```typescript
    // SlideType - 12 known types + unknown
    export type SlideType = 'title' | 'problem' | 'solution' | 'market' | 'product' | 'business_model' | 'traction' | 'competition' | 'team' | 'financials' | 'ask' | 'appendix' | 'unknown';

    // All 12 known slide types (excluding 'unknown')
    export const SLIDE_TYPES: SlideType[] = ['title', 'problem', 'solution', 'market', 'product', 'business_model', 'traction', 'competition', 'team', 'financials', 'ask', 'appendix'];

    // Core slides every investor expects -- used for structure scoring
    export const REQUIRED_SLIDES: SlideType[] = ['title', 'problem', 'solution', 'market', 'traction', 'team', 'ask'];

    // Human-readable labels
    export const SLIDE_LABELS: Record<SlideType, string> = {
      title: 'Title Slide', problem: 'Problem', solution: 'Solution',
      market: 'Market Size', product: 'Product', business_model: 'Business Model',
      traction: 'Traction', competition: 'Competition', team: 'Team',
      financials: 'Financials', ask: 'The Ask', appendix: 'Appendix', unknown: 'Unknown'
    };

    // What each slide should contain
    export const SLIDE_DESCRIPTIONS: Record<SlideType, string> = { ... };
    ```

    Also define interfaces:
    - `SlideClassification`: { type: SlideType; confidence: number; reasoning: string }
    - `SlideAnalysis`: { pageNumber: number; type: SlideType; typeConfidence: number; score: number; feedback: string; strengths: string[]; suggestions: string[] }
    - `PitchReview`: { id?: string; userId?: string; documentId: string; overallScore: number; structureScore: number; contentScore: number; slides: SlideAnalysis[]; missingSections: SlideType[]; strengths: string[]; improvements: string[]; createdAt?: Date }
    - `PitchReviewInput`: { documentId: string; pages: Array<{ pageNumber: number; content: string }> }
    - `DeckStructure`: { slides: SlideClassification[]; totalSlides: number; identifiedTypes: SlideType[] }

    **3. Slide Classifier: lib/fred/pitch/slide-classifier.ts**
    Use exact same import pattern as lib/fred/irs/engine.ts:
    ```typescript
    import { generateObject } from 'ai';
    import { openai } from '@ai-sdk/openai';
    import { z } from 'zod';
    ```

    Two functions:
    - `classifySlide(content, pageNumber, totalPages)`: Single-slide classification. Zod schema: z.object({ type: z.enum([...SLIDE_TYPES, 'unknown']), confidence: z.number().min(0).max(1), reasoning: z.string() }). System prompt explains all 12 types with position hints (page 1 = likely title, last pages = likely ask/appendix).
    - `classifyDeck(pages)`: Batch classify ALL pages in a single generateObject call for efficiency. Schema: z.object({ classifications: z.array(SingleClassSchema) }). Prompt includes all page contents numbered. Returns DeckStructure with identifiedTypes derived from classifications.

    Use temperature 0.2 for classification (low creativity, high accuracy).

    **4. Analyzers: lib/fred/pitch/analyzers/index.ts**
    Single file with dispatcher pattern (NOT separate files per type).

    Define criteria per slide type as a const record:
    ```typescript
    const SLIDE_CRITERIA: Record<SlideType, string[]> = {
      problem: ['Is the problem clearly stated?', 'Is it relatable/emotional?', 'Supporting statistics present?', 'Urgency conveyed?'],
      solution: ['Solution clearly explained?', 'Directly addresses stated problem?', 'Differentiated from alternatives?', 'Believable/feasible?'],
      market: ['TAM/SAM/SOM defined?', 'Sources credible?', 'Math reasonable?', 'Clear market wedge?'],
      traction: ['Key metrics clearly presented?', 'Growth rate highlighted?', 'Milestones notable?', 'Data recent?'],
      team: ['Key members shown?', 'Relevant experience highlighted?', 'Notable credentials?', 'Team complete for stage?'],
      ask: ['Amount clearly stated?', 'Use of funds specified?', 'Runway explained?', 'Milestones tied to funding?'],
      // Add basic criteria for remaining types (title, product, business_model, competition, financials, appendix, unknown)
    };
    ```

    Export `analyzeSlide(content: string, type: SlideType, pageNumber: number): Promise<SlideAnalysis>`:
    Uses generateObject with Zod schema returning { score: z.number().min(0).max(100), feedback: z.string(), strengths: z.array(z.string()), suggestions: z.array(z.string()) }.
    System prompt includes: slide type, its criteria, Fred Cary voice ("direct, no-BS advisor"). Temperature 0.3.

    **5. Review Engine: lib/fred/pitch/review-engine.ts**
    Main entry following lib/fred/irs/engine.ts pattern.

    Export `reviewPitchDeck(input: PitchReviewInput): Promise<PitchReview>`:
    1. Call `classifyDeck(input.pages)` to get DeckStructure
    2. For each page, call `analyzeSlide(page.content, classifiedType, page.pageNumber)` -- run in parallel with Promise.all for speed
    3. Calculate `structureScore` deterministically (no AI call):
       - Start at 100
       - For each REQUIRED_SLIDE not found: -12 points (7 required slides, missing all = 16 points left)
       - If total slides > 20: -10 (too many)
       - If total slides < 8: -10 (too few)
       - Clamp to 0-100
    4. Calculate `contentScore`: Math.round(average of all slide.score values)
    5. Calculate `overallScore`: Math.round(structureScore * 0.4 + contentScore * 0.6)
    6. Identify `missingSections`: REQUIRED_SLIDES.filter(type => !structure.identifiedTypes.includes(type))
    7. Compile strengths: top 3 slides by score, take their first strength item
    8. Compile improvements: bottom 3 slides by score, take their first suggestion item
    9. Return PitchReview object

    Helper functions (not exported):
    - `calculateStructureScore(structure: DeckStructure): number`
    - `identifyMissingSections(structure: DeckStructure): SlideType[]`

    **6. Database: lib/fred/pitch/db.ts**
    Follow lib/fred/irs/db.ts pattern exactly. Same Supabase client init:
    ```typescript
    import { createClient } from '@supabase/supabase-js';
    const supabase = createClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.SUPABASE_SERVICE_ROLE_KEY!);
    ```

    Functions:
    - `savePitchReview(userId, review)`: Insert into pitch_reviews with snake_case mapping, return mapped result
    - `getPitchReview(userId, reviewId)`: Get by ID, return null if not found (check PGRST116)
    - `getPitchReviews(userId, limit=10)`: List newest first
    - `getPitchReviewByDocument(userId, documentId)`: Get latest review for a specific document
    - Private `mapDbToReview(row)`: Map snake_case DB row to camelCase PitchReview

    **7. Barrel: lib/fred/pitch/index.ts**
    ```typescript
    export * from './types';
    export { classifySlide, classifyDeck } from './slide-classifier';
    export { analyzeSlide } from './analyzers';
    export { reviewPitchDeck } from './review-engine';
    export { savePitchReview, getPitchReview, getPitchReviews, getPitchReviewByDocument } from './db';
    ```
  </action>
  <verify>
    ```bash
    ls lib/fred/pitch/types.ts lib/fred/pitch/slide-classifier.ts lib/fred/pitch/analyzers/index.ts lib/fred/pitch/review-engine.ts lib/fred/pitch/db.ts lib/fred/pitch/index.ts lib/db/migrations/026_pitch_reviews.sql
    npx tsc --noEmit 2>&1 | head -30
    ```
    All 7 files must exist. TypeScript must compile without errors in the pitch module.
  </verify>
  <done>
    All 7 files created. lib/fred/pitch/ follows exact same pattern as lib/fred/irs/ (types, engine, db, barrel). Slide classifier handles 12 types via batch AI call. Review engine orchestrates classify + analyze + score. DB module does CRUD on pitch_reviews table. Migration creates the table with proper indexes. TypeScript compiles cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Pitch Review API + UI Components + Dashboard Page</name>
  <files>
    app/api/fred/pitch-review/route.ts
    components/pitch/review-summary.tsx
    components/pitch/deck-overview.tsx
    components/pitch/slide-analysis-panel.tsx
    components/pitch/index.ts
    app/dashboard/pitch-deck/page.tsx
  </files>
  <action>
    **1. API Route: app/api/fred/pitch-review/route.ts**
    Follow app/api/fred/investor-readiness/route.ts pattern exactly.

    ```typescript
    import { NextRequest, NextResponse } from 'next/server';
    import { checkTierForRequest } from '@/lib/api/tier-middleware';
    import { UserTier } from '@/lib/constants';
    import { getDocumentById, getDocumentChunks } from '@/lib/db/documents';
    import { reviewPitchDeck, savePitchReview, getPitchReviews, getPitchReviewByDocument } from '@/lib/fred/pitch';
    ```

    POST handler:
    1. `checkTierForRequest(request, UserTier.PRO)` -- return 403 `{ error: 'Pro tier required for Pitch Deck Review' }` if not allowed
    2. Get `userId` from `tierCheck.user!.id`
    3. Parse body: `{ documentId: string }`
    4. Validate documentId present (return 400 if missing)
    5. Call `getDocumentById(userId, documentId)` -- return 404 if null
    6. Call `getDocumentChunks(documentId)` -- get page-level chunks from PDF pipeline
    7. Build pages array: `chunks.map(c => ({ pageNumber: c.pageNumber || c.chunkIndex + 1, content: c.content }))`. Sort by pageNumber.
    8. Call `reviewPitchDeck({ documentId, pages })`
    9. Call `savePitchReview(userId, review)`
    10. Return `{ success: true, review: savedReview }`
    11. Wrap in try/catch, `console.error('[PitchReview API]', error)`, return 500

    GET handler:
    1. Same tier check
    2. Parse searchParams: `documentId` (optional), `limit` (optional, default 10)
    3. If `documentId`: call `getPitchReviewByDocument(userId, documentId)`, return `{ success: true, review }`
    4. Otherwise: call `getPitchReviews(userId, limit)`, return `{ success: true, reviews, count }`

    **2. UI Components under components/pitch/**

    **components/pitch/review-summary.tsx** -- "use client"
    Props: `{ review: PitchReview }`
    - Import ScoreGauge from `@/components/irs/score-gauge` (reuse existing component)
    - Import Card, CardContent, CardHeader, CardTitle from `@/components/ui/card`
    - Import SLIDE_LABELS from `@/lib/fred/pitch/types`
    - Layout: ScoreGauge (size="lg") for overall on the left, stats on the right
    - Two progress bars: Structure Score and Content Score with percentage labels
    - Progress bars use Tailwind: `<div className="h-2 rounded-full bg-gray-200"><div className="h-full rounded-full" style={{ width: `${score}%`, backgroundColor: scoreColor }} /></div>`
    - Strengths: green check icon + text list
    - Improvements: orange arrow icon + text list
    - Missing sections: red outline badges using SLIDE_LABELS[type] for display names
    - Brand orange #ff6a1a for primary elements

    **components/pitch/deck-overview.tsx** -- "use client"
    Props: `{ slides: SlideAnalysis[]; selectedIndex: number | null; onSelectSlide: (index: number) => void }`
    - Import SLIDE_LABELS from `@/lib/fred/pitch/types`
    - Grid: `grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3`
    - Each card: clickable div with border coloring based on score (red < 50, yellow 50-69, green >= 70)
    - Selected card: `ring-2 ring-[#ff6a1a]` border highlight
    - Card content: page number (small, top-left), slide type badge (top-right), score number (center, large), truncated feedback (bottom, max 2 lines)
    - Hover effect: `hover:shadow-md transition-shadow`

    **components/pitch/slide-analysis-panel.tsx** -- "use client"
    Props: `{ slide: SlideAnalysis; onClose?: () => void }`
    - Import Card, CardContent, CardHeader, CardTitle from `@/components/ui/card`
    - Import SLIDE_LABELS from `@/lib/fred/pitch/types`
    - Header: Slide type label + confidence badge (e.g., "Problem Slide - 95% confident")
    - Score display: large number with color coding
    - Feedback: paragraph text
    - Strengths: list with green CheckCircle2 icons
    - Suggestions: list with orange Lightbulb icons (from lucide-react)
    - Close button (X icon) if onClose provided

    **components/pitch/index.ts**
    Barrel export:
    ```typescript
    export { ReviewSummary } from './review-summary';
    export { DeckOverview } from './deck-overview';
    export { SlideAnalysisPanel } from './slide-analysis-panel';
    ```

    **3. Dashboard Page: app/dashboard/pitch-deck/page.tsx**
    REPLACE the entire existing static mock. This must be a "use client" component.

    Follow the app/dashboard/investor-readiness/page.tsx layout pattern:

    State:
    - `documents`: uploaded pitch deck documents list
    - `review`: PitchReview | null (current review result)
    - `selectedSlideIndex`: number | null
    - `loading`: boolean (initial page load)
    - `reviewing`: boolean (AI review in progress)
    - `error`: string | null

    On mount (useEffect):
    - Fetch user's uploaded documents: `fetch('/api/documents/uploaded')` and filter to type === 'pitch_deck' in the response, OR use the documents API with type filter. Set `documents` state. Handle 403 gracefully (user not Pro).

    Header section (same pattern as investor-readiness page):
    - ArrowLeft back to /dashboard
    - Title: "Pitch Deck Review"
    - Subtitle: "AI-powered slide-by-slide analysis of your pitch deck"
    - Pro badge

    Document selector:
    - If no documents: show message "Upload a pitch deck first" with link to /dashboard (where document upload exists)
    - If documents exist: show select dropdown (use the HTML select or the shadcn Select component from @/components/ui/select) listing document names. When a document is selected, check if a review already exists via GET /api/fred/pitch-review?documentId=X. If it does, load and display it. If not, show "Review Deck" button.

    Review trigger:
    - "Review Deck" button: POST to `/api/fred/pitch-review` with `{ documentId }`
    - While reviewing: show Loader2 spinner with text "FRED is analyzing your deck slide by slide..."
    - On success: set review state, clear reviewing

    Review display (when review exists):
    - Two-column layout: `grid grid-cols-1 lg:grid-cols-3 gap-8`
    - Left column (lg:col-span-2):
      - ReviewSummary component at top
      - DeckOverview component below (passes selectedSlideIndex + onSelectSlide)
    - Right column (lg:col-span-1):
      - If a slide is selected: SlideAnalysisPanel component for that slide
      - If no slide selected: prompt "Click a slide to see detailed analysis"

    Error handling: AlertCircle banner for errors (same pattern as investor-readiness page)

    Import paths:
    ```typescript
    import { ReviewSummary, DeckOverview, SlideAnalysisPanel } from '@/components/pitch';
    import type { PitchReview } from '@/lib/fred/pitch/types';
    import { ScoreGauge } from '@/components/irs/score-gauge';
    ```
  </action>
  <verify>
    ```bash
    ls app/api/fred/pitch-review/route.ts components/pitch/review-summary.tsx components/pitch/deck-overview.tsx components/pitch/slide-analysis-panel.tsx components/pitch/index.ts app/dashboard/pitch-deck/page.tsx
    npx tsc --noEmit 2>&1 | head -30
    grep -l "checkTierForRequest" app/api/fred/pitch-review/route.ts
    grep -l "reviewPitchDeck" app/api/fred/pitch-review/route.ts
    grep -l "fetch.*pitch-review" app/dashboard/pitch-deck/page.tsx
    ```
    All files exist. TypeScript compiles. API route uses tier middleware and calls engine. Dashboard page fetches from API.
  </verify>
  <done>
    POST /api/fred/pitch-review requires Pro tier, loads document chunks, runs AI review, persists to DB, returns result. GET endpoint returns stored reviews by documentId or lists all. Dashboard page at /dashboard/pitch-deck is fully functional: selects document, triggers review, displays ReviewSummary + DeckOverview + SlideAnalysisPanel. Static mock is replaced with real AI-powered functionality.
  </done>
</task>

</tasks>

<verification>
1. `ls lib/fred/pitch/` shows: types.ts, slide-classifier.ts, analyzers/index.ts, review-engine.ts, db.ts, index.ts
2. `ls app/api/fred/pitch-review/` shows: route.ts
3. `ls components/pitch/` shows: review-summary.tsx, deck-overview.tsx, slide-analysis-panel.tsx, index.ts
4. `ls app/dashboard/pitch-deck/page.tsx` exists (no longer static mock)
5. `ls lib/db/migrations/026_pitch_reviews.sql` exists
6. `npx tsc --noEmit` passes
7. `grep -r "checkTierForRequest" app/api/fred/pitch-review/route.ts` confirms Pro tier gating
8. `grep -r "reviewPitchDeck" app/api/fred/pitch-review/route.ts` confirms engine wiring
9. `grep -r "generateObject" lib/fred/pitch/slide-classifier.ts lib/fred/pitch/analyzers/index.ts` confirms AI integration
10. `grep -r "classifyDeck" lib/fred/pitch/review-engine.ts` confirms engine orchestration
11. `grep -r "ScoreGauge" components/pitch/review-summary.tsx` confirms reuse of existing component
</verification>

<success_criteria>
- lib/fred/pitch/ module exists with types, classifier, analyzers, engine, db, barrel (mirrors lib/fred/irs/)
- Slide classifier identifies 12 slide types using generateObject + Zod
- Per-slide analysis produces score 0-100, feedback, strengths, suggestions
- Overall scoring: 40% structure + 60% content
- Missing sections identified by comparing classified types against 7 REQUIRED_SLIDES
- API: POST /api/fred/pitch-review is Pro-tier gated, accepts documentId, returns full review
- API: GET /api/fred/pitch-review returns stored reviews
- Database: pitch_reviews table with slides JSONB, scores, strengths, improvements
- Dashboard page at /dashboard/pitch-deck replaces static mock with functional AI review
- UI: slide-by-slide navigation with deck overview grid and analysis panel
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-pro-tier/03-06-SUMMARY.md`
</output>
