# Phase 41-02: Community UI Pages + Components + Mobile/Tablet Responsive Design

**Phase:** 41 — Founder Communities
**Plan:** 02 of 2 (Frontend)
**Wave:** 5 (parallel with Phase 40)
**Depends on:** 41-01 (DB schema + API routes must exist)
**Status:** PENDING
**autonomous:** true

## Goal

Build the complete frontend for Founder Communities: dashboard pages for browsing, creating, viewing, and interacting with communities. All pages must be mobile-first with specific responsive breakpoints for tablet and desktop. Components include CommunityCard, CommunityFeed, PostCard, CreatePostForm, ReplyThread, and ModerationTools.

## Requirements Addressed

- **COMM-01**: Founders can create communities around topics, industries, or stages (self-started, not admin-curated)
- **COMM-02**: Founders can browse and join communities from the dashboard
- **COMM-03**: Community feeds show posts, questions, and updates from members
- **COMM-04**: Communities are self-moderated by users with basic moderation tools

---

## Responsive Breakpoint Strategy

All pages follow mobile-first design:

| Breakpoint | Width | Target | Tailwind Prefix |
|------------|-------|--------|-----------------|
| Base (mobile) | 375px+ | iPhone 12/13/14 | (none) |
| Tablet | 768px+ | iPad | `md:` |
| Tablet Pro | 1024px+ | iPad Pro | `lg:` |
| Desktop | 1440px+ | Laptop/Desktop | `xl:` |

**Global Rules:**
- Touch targets: 44px minimum on all interactive elements (already enforced via globals.css `.touch-target` class)
- Font sizes: base 14px mobile, 16px tablet+
- Padding: 16px mobile, 24px tablet, 32px desktop
- Max content width: 768px for feed/post content on desktop (prevents ultra-wide readability issues)

---

## Step 1: Add "Communities" to Dashboard Navigation

**File:** `app/dashboard/dashboard-shell.tsx`

Add a new nav item to the `navItems` array:
```typescript
{
  name: "Communities",
  href: "/dashboard/communities",
  icon: <UsersIcon className="h-4 w-4" />,  // from lucide-react "Users"
}
```

Place it after "Boardy Integration" and before "Notifications" in the nav list. No tier gating — communities are available to all tiers (Free, Pro, Studio).

---

## Step 2: Communities Browse Page

**File:** `app/dashboard/communities/page.tsx`

This is the main entry point: browse all communities, search, filter, and create.

### Layout (Mobile-First)

**Mobile (375px):**
- Full-width header: "Communities" title + "Create" button (right-aligned)
- Search input: full-width, 44px height
- Category filter: horizontal scrollable pill bar (overflow-x-auto)
- Community cards: single column, full-width
- Spacing: `space-y-4`, `px-0` (container handles padding)

**Tablet (768px):**
- Header: title + search input inline + "Create Community" button
- Category filter: wrapping flex row
- Community cards: 2-column grid (`md:grid-cols-2 gap-4`)

**Desktop (1024px+):**
- Same layout but 3-column grid (`lg:grid-cols-3 gap-6`)
- Sidebar with "My Communities" list (optional enhancement)

### Behavior
- Fetch communities from `GET /api/communities?category=X&search=Y&limit=20`
- Show loading skeleton (grid of card skeletons matching column count)
- Empty state: illustration + "No communities found. Be the first to create one!"
- Infinite scroll or "Load More" button for pagination
- Category pills: All, Industry, Stage, Topic, General
- "My Communities" tab/toggle to show only joined communities

### Component: `CommunityCard`
**File:** `components/communities/CommunityCard.tsx`

A card showing community summary. Used in the browse grid.

```
[Cover image or gradient fallback]
[Name]                    [Member count badge]
[Description - 2 lines max, truncated]
[Category badge]  [Join / Joined button]
```

**Responsive:**
- Mobile: full-width card, 16px padding, stacked layout
- Tablet/Desktop: fixed-height card in grid, hover state with subtle lift

**Props:** `community: Community, isMember: boolean, onJoin: () => void`

**Styling:**
- Uses `Card`, `CardContent`, `Badge`, `Button` from `@/components/ui/`
- Orange gradient accent on hover border (`hover:border-[#ff6a1a]/30`)
- Cover image: aspect-ratio 16/9 with fallback gradient based on category
- Join button: 44px touch target, orange primary when not joined, outline when joined
- Member count: `Users` icon + count

---

## Step 3: Create Community Dialog/Page

**File:** `components/communities/CreateCommunityDialog.tsx`

A modal dialog for creating a new community. Opens from the "Create Community" button on the browse page.

### Form Fields
1. **Name** — text input, required, 2-100 chars
2. **Description** — textarea, required, max 500 chars, with character counter
3. **Category** — select dropdown: Industry, Stage, Topic, General
4. **Private** — toggle switch: "Only visible to members"

### Responsive
- Mobile: dialog takes full screen (`DialogContent` with `className="sm:max-w-lg w-full"`)
- All form fields: full-width, 44px min-height inputs
- Submit button: full-width on mobile, auto-width on desktop
- Character counter: right-aligned below textarea

### Behavior
- POST to `/api/communities`
- On success: redirect to new community page, show toast
- On error: show inline error message
- Client-side validation before submit

---

## Step 4: Community Detail Page (Feed)

**File:** `app/dashboard/communities/[slug]/page.tsx`

The main community view — header + feed of posts.

### Layout

**Header Section:**
```
[Cover image / gradient - full width, 120px mobile / 180px desktop]
[Community name]
[Description]
[Member count] [Category badge] [Join/Leave button]
[Moderator tools dropdown - if owner/moderator]
```

**Feed Section:**
- Create post input bar: "What's on your mind?" click-to-expand
- Post list: chronological, pinned posts first
- Each post: PostCard component

**Mobile (375px):**
- Full-width, no horizontal margins (container padding only)
- Cover image: 120px height
- Header info stacked vertically
- Feed posts: full-width cards with 12px spacing
- Create post bar: full-width, simplified

**Tablet (768px):**
- Cover image: 160px height
- Header: name + description left, stats + actions right (flex row)
- Feed: max-width 640px, centered
- `md:max-w-2xl md:mx-auto`

**Desktop (1024px+):**
- Cover image: 180px height
- Two-column layout: feed (left, 2/3) + sidebar (right, 1/3)
- Sidebar: Members list, Community info, Moderation tools
- Feed: `lg:max-w-3xl`

### Behavior
- Fetch community from `GET /api/communities/[slug]`
- Fetch posts from `GET /api/communities/[slug]/posts?limit=20`
- If not a member: show community info + "Join to see posts" CTA
- If member: show full feed with create post ability
- Load more posts on scroll or button click

---

## Step 5: PostCard Component

**File:** `components/communities/PostCard.tsx`

Displays a single post in the community feed.

```
[Author avatar] [Author name] [Time ago] [...menu if owner/mod]
[Post title - if present]
[Post content - markdown rendered, max 300 chars with "Read more"]
[Post type badge if question/update/milestone]
---
[Reaction buttons: Like | Insightful | Support] [Reply count + button]
```

**Responsive:**
- Mobile: full-width, compact spacing (12px padding)
- All touch targets: 44px minimum (reaction buttons, menu, reply)
- Content: text-sm on mobile, text-base on tablet+
- Author row: avatar (32px) + name + time in single line
- Reaction bar: horizontal scroll if needed on very narrow screens

**Props:** `post: CommunityPost, currentUserId: string, userRole: string | null, onReact: ..., onReply: ..., onDelete: ..., onPin: ...`

**Interaction:**
- Click reaction: toggles via `POST /api/communities/[slug]/posts/[postId]/reactions`
- Click reply: expands reply section below
- Three-dot menu (author): Edit, Delete
- Three-dot menu (moderator): Pin/Unpin, Delete
- "Read more" expands full content inline

---

## Step 6: CreatePostForm Component

**File:** `components/communities/CreatePostForm.tsx`

Expandable form for creating a new post in a community.

### Collapsed State
- Single-line bar: avatar + "What's on your mind?" placeholder
- 44px height, full-width
- Click to expand

### Expanded State
- Title input (optional): "Give your post a title"
- Content textarea: auto-growing, max 5000 chars, character counter
- Post type selector: pills for Post, Question, Update, Milestone
- Submit button: "Post" (right-aligned)
- Cancel button: collapses form

**Responsive:**
- Mobile: full-width, title input full-width, textarea full-width
- Tablet+: same but constrained by parent max-width
- All inputs: 44px min-height
- Submit/Cancel row: flex with gap-2, buttons auto-width mobile, specific width desktop

---

## Step 7: ReplyThread Component

**File:** `components/communities/ReplyThread.tsx`

Threaded reply view below a post.

### Layout
```
[Reply input: avatar + text input + Submit]
---
[Reply 1: avatar, name, time, content]
  [Nested reply: indented with left border]
[Reply 2: avatar, name, time, content]
```

**Responsive:**
- Mobile: max 2 levels of nesting (deeper replies flatten)
- Nesting indent: 16px per level on mobile, 24px on tablet+
- Left border: 2px solid gray-200 on nested replies
- Reply input: full-width, 44px height
- All reply text: text-sm
- Reply actions: small "Reply" text button (44px touch area via padding)

**Props:** `postId: string, communitySlug: string, replies: CommunityPostReply[], currentUserId: string, userRole: string | null`

**Behavior:**
- Fetch replies from `GET /api/communities/[slug]/posts/[postId]/replies`
- Submit reply via `POST .../replies`
- "Reply" link on each reply opens inline reply input below that reply
- Delete own reply, moderator can delete any

---

## Step 8: ModerationTools Component

**File:** `components/communities/ModerationTools.tsx`

Tools for community owner/moderators. Only visible to users with `owner` or `moderator` role.

### Features
- **Pin/Unpin posts**: Toggle via post three-dot menu
- **Delete posts**: With confirmation dialog
- **Remove members**: On member list, with confirmation
- **Promote/Demote moderators**: On member list
- **Edit community**: Name, description, category, cover image
- **Archive community**: With confirmation dialog

**Responsive:**
- Mobile: all actions accessible via dropdown menus (not inline buttons)
- Tablet+: inline action buttons on member rows
- All confirmation dialogs: AlertDialog component (already in codebase)
- Touch targets: 44px on all action buttons

---

## Step 9: Members Page

**File:** `app/dashboard/communities/[slug]/members/page.tsx`

Full members list for a community.

### Layout

**Mobile (375px):**
- List view: avatar + name + role badge per row
- Full-width rows, 56px min-height (44px touch target + padding)
- Owner/mod actions: three-dot menu per member

**Tablet (768px+):**
- Same list but with "Joined" date column
- Inline promote/remove buttons for owner/moderators
- `md:max-w-2xl md:mx-auto`

**Desktop (1024px+):**
- Same as tablet, sidebar with community info

### Behavior
- Fetch from `GET /api/communities/[slug]/members`
- Owner sees: promote to moderator, demote, remove buttons
- Moderator sees: remove member button
- Regular member sees: view only
- "Invite" button (stretch goal): copy community link

---

## Step 10: Loading States and Skeletons

**File:** `components/communities/CommunitySkeleton.tsx`

Create skeleton loading components matching the responsive layouts:

- `CommunityCardSkeleton`: matches CommunityCard dimensions at each breakpoint
- `PostCardSkeleton`: matches PostCard layout
- `MemberRowSkeleton`: matches member list row

Use `animate-pulse` with gray placeholder blocks. Match exact heights and widths at each breakpoint so layout does not shift when data loads.

---

## Step 11: Empty States

Add empty states for each view:

- **No communities found** (browse page): Icon + "No communities yet. Be the first to create one!" + "Create Community" button
- **No posts yet** (community feed): Icon + "No posts yet. Start the conversation!" + "Create Post" button
- **No replies yet** (reply thread): "Be the first to reply"
- **Not a member** (community feed): Community info card + "Join this community to see posts and participate" + "Join" button

All empty states: centered, full-width on mobile, constrained max-width on desktop.

---

## Responsive Specification Summary

### CommunityCard Grid
| Viewport | Columns | Gap | Card Min Height |
|----------|---------|-----|-----------------|
| Mobile (375px) | 1 | 12px | auto |
| Tablet (768px) | 2 | 16px | auto |
| Desktop (1024px) | 3 | 24px | auto |

**Tailwind:** `grid grid-cols-1 gap-3 md:grid-cols-2 md:gap-4 lg:grid-cols-3 lg:gap-6`

### Feed Posts
| Viewport | Max Width | Padding |
|----------|-----------|---------|
| Mobile | 100% | 12px |
| Tablet | 640px (centered) | 16px |
| Desktop | 768px (centered) | 24px |

**Tailwind:** `w-full md:max-w-2xl md:mx-auto lg:max-w-3xl`

### Form Fields
| Viewport | Width | Height |
|----------|-------|--------|
| Mobile | 100% | 44px min |
| Tablet+ | 100% (constrained by parent) | 44px min |

### Touch Targets
- All buttons: `min-h-[44px] min-w-[44px]` or `.touch-target` class
- All clickable list items: `min-h-[44px]` with padding
- Reaction buttons: `p-2` with `min-h-[44px]`
- Three-dot menus: `h-10 w-10` (40px icon button + 2px focus ring = 44px)

### Navigation
- Dashboard sidebar: "Communities" nav item added (no tier gating)
- Community pages: breadcrumb trail on tablet+ (`Communities > Community Name`)
- Mobile: back button in header instead of breadcrumbs

---

## Verification

- [ ] Communities browse page renders at 375px, 768px, 1024px, 1440px without horizontal overflow
- [ ] Community cards: 1 column at 375px, 2 columns at 768px, 3 columns at 1024px+
- [ ] All interactive elements have 44px minimum touch targets
- [ ] Create community form works on mobile (full-width fields, proper keyboard handling)
- [ ] Community feed posts are full-width on mobile, constrained on desktop
- [ ] Reply thread nesting limited to 2 levels on mobile
- [ ] Moderation tools accessible on mobile via dropdown menus
- [ ] Loading skeletons match layout at each breakpoint (no layout shift)
- [ ] Empty states display correctly at all viewports
- [ ] "Communities" appears in dashboard sidebar navigation
- [ ] Join/Leave functionality works from both browse page and community detail
- [ ] Post creation, reactions, and replies work correctly
- [ ] Moderator can pin/delete posts and remove members
- [ ] Owner can edit community details and promote/demote moderators
- [ ] `npx tsc --noEmit` passes
- [ ] `npm run test` passes
- [ ] Dark mode: all community components render correctly in dark theme

## must_haves

- Communities browse page with responsive grid (1/2/3 columns)
- Community detail page with feed
- Create community dialog
- CommunityCard, PostCard, CreatePostForm, ReplyThread components
- ModerationTools for owner/moderator role
- Members page with role-based actions
- Dashboard nav entry for Communities
- 44px touch targets on all interactive elements
- Mobile-first responsive design at 375px/768px/1024px/1440px
- Loading skeletons and empty states
- Dark mode support

## Files Modified/Created

### New Files
- `app/dashboard/communities/page.tsx` — browse communities page
- `app/dashboard/communities/[slug]/page.tsx` — community detail/feed page
- `app/dashboard/communities/[slug]/members/page.tsx` — members list page
- `components/communities/CommunityCard.tsx` — community card component
- `components/communities/CreateCommunityDialog.tsx` — create community form
- `components/communities/PostCard.tsx` — post card component
- `components/communities/CreatePostForm.tsx` — create post form
- `components/communities/ReplyThread.tsx` — threaded replies component
- `components/communities/ModerationTools.tsx` — moderation tools component
- `components/communities/CommunitySkeleton.tsx` — loading skeleton components

### Modified Files
- `app/dashboard/dashboard-shell.tsx` — add "Communities" nav item to `navItems` array
