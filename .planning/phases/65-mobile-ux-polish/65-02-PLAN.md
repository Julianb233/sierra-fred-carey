---
phase: 65-mobile-ux-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/animations/PageTransition.tsx
  - components/animations/FadeIn.tsx
  - app/dashboard/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard page transitions animate smoothly on route changes"
    - "Dashboard cards and content sections fade in on scroll"
    - "Animations are disabled when user prefers reduced motion"
  artifacts:
    - path: "components/animations/PageTransition.tsx"
      provides: "Reusable page transition wrapper with framer-motion"
      exports: ["PageTransition"]
      min_lines: 15
    - path: "components/animations/FadeIn.tsx"
      provides: "Scroll-triggered fade-in animation component"
      exports: ["FadeIn"]
      min_lines: 15
    - path: "app/dashboard/layout.tsx"
      provides: "Dashboard layout with animated page transitions"
      contains: "PageTransition"
  key_links:
    - from: "app/dashboard/layout.tsx"
      to: "components/animations/PageTransition.tsx"
      via: "import and wrapping children"
      pattern: "import.*PageTransition"
    - from: "components/animations/PageTransition.tsx"
      to: "framer-motion"
      via: "motion.div with variants"
      pattern: "from.*framer-motion"
---

<objective>
Add smooth page transitions and interaction animations to the dashboard. Create reusable animation components using the already-installed framer-motion library, and integrate page transitions into the dashboard layout.

Purpose: The dashboard currently has no page transition animations -- route changes are instant and jarring. Smooth animations improve perceived performance and polish.

Output: `PageTransition.tsx` and `FadeIn.tsx` animation components, updated `app/dashboard/layout.tsx` with page transitions wrapping children.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/65-mobile-ux-polish/65-RESEARCH.md

Key existing files:
@app/dashboard/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create animation components</name>
  <files>components/animations/PageTransition.tsx, components/animations/FadeIn.tsx</files>
  <action>
1. Create `components/animations/PageTransition.tsx`:
   - `"use client"` directive
   - Import `motion`, `AnimatePresence`, `useReducedMotion` from `framer-motion`
   - Import `usePathname` from `next/navigation`
   - Define `pageVariants`: `initial: { opacity: 0, y: 8 }`, `animate: { opacity: 1, y: 0 }`, `exit: { opacity: 0, y: -8 }`
   - Export `PageTransition` component that:
     - Calls `usePathname()` for the key prop
     - Calls `useReducedMotion()` -- if true, set duration to 0
     - Renders `<AnimatePresence mode="wait">` wrapping `<motion.div>` with `key={pathname}`, `variants={pageVariants}`, `initial="initial"`, `animate="animate"`, `exit="exit"`, `transition={{ duration: shouldReduceMotion ? 0 : 0.2, ease: "easeOut" }}`
   - Accept `children: React.ReactNode` prop
   - Add `className="min-h-0"` to the motion.div to avoid layout issues

2. Create `components/animations/FadeIn.tsx`:
   - `"use client"` directive
   - Import `motion`, `useReducedMotion` from `framer-motion`
   - Export `FadeIn` component with props: `children: React.ReactNode`, `delay?: number` (default 0), `className?: string`
   - Uses `whileInView` animation: `initial={{ opacity: 0, y: 16 }}`, `whileInView={{ opacity: 1, y: 0 }}`
   - `viewport={{ once: true, margin: "-50px" }}`
   - Respects reduced motion: if `useReducedMotion()` returns true, set duration to 0
   - Normal transition: `{ duration: 0.4, delay, ease: "easeOut" }`
   - Pass through `className` prop

Both components must use transform-based animations only (opacity, translateY) -- never animate width, height, top, left.
  </action>
  <verify>
- `components/animations/PageTransition.tsx` exists and exports `PageTransition`
- `components/animations/FadeIn.tsx` exists and exports `FadeIn`
- Both files include `useReducedMotion` handling
- TypeScript: no errors in these files
  </verify>
  <done>Two reusable animation components created with reduced motion support</done>
</task>

<task type="auto">
  <name>Task 2: Integrate PageTransition into dashboard layout</name>
  <files>app/dashboard/layout.tsx</files>
  <action>
1. Import `PageTransition` from `@/components/animations/PageTransition`

2. In the `DashboardLayout` component, wrap `{children}` with `<PageTransition>`:
   - Find the `<main>` element (line ~442)
   - Inside the `<div className="container ...">`, wrap `{children}` with `<PageTransition>{children}</PageTransition>`
   - The result should look like:
     ```tsx
     <main className="flex-1 overflow-y-auto">
       <div className="container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 pb-28 md:pb-8">
         <PageTransition>
           {children}
         </PageTransition>
       </div>
     </main>
     ```

3. Do NOT modify any other part of the dashboard layout -- keep all sidebar, mobile nav, floating chat, and call modal code unchanged.

4. Do NOT add AnimatePresence at the layout level -- it is already inside PageTransition component.
  </action>
  <verify>
- `app/dashboard/layout.tsx` imports PageTransition
- `{children}` is wrapped with `<PageTransition>`
- `npm run build` succeeds
- No other changes to dashboard layout structure
  </verify>
  <done>Dashboard pages animate smoothly on route changes with fade+slide transition, respecting prefers-reduced-motion</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds
2. `components/animations/PageTransition.tsx` and `FadeIn.tsx` exist with correct exports
3. `app/dashboard/layout.tsx` wraps children in PageTransition
4. Both animation components respect `useReducedMotion`
</verification>

<success_criteria>
- Dashboard route changes show smooth 200ms fade+slide transition
- Scroll-triggered FadeIn component available for use across pages
- All animations disabled when user has prefers-reduced-motion enabled
- No layout shifts or visual glitches during transitions
- Build succeeds with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/65-mobile-ux-polish/65-02-SUMMARY.md`
</output>
