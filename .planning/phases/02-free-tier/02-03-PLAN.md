# Plan 02-03: Decision History and Context Tracking

**Status:** COMPLETED
**Phase:** 02 - Free Tier Features
**Depends On:** 02-01 (Reality Lens)
**Estimated Complexity:** Medium

---

## Objective

Create a decision history UI that allows users to:
1. View past conversations with FRED
2. See decisions made and their outcomes
3. Track context learned about their startup
4. Review Reality Lens assessments

---

## Current State Analysis

**Existing:**
- `lib/db/fred-memory.ts` - Memory CRUD operations (episodic, semantic)
- `app/api/fred/memory/route.ts` - Memory API endpoints
- Database tables for fred_episodic_memory, fred_semantic_memory

**Missing:**
- UI to display decision history
- Session browser component
- Decision outcome tracking UI

---

## Implementation Steps

### Step 1: Create History API Endpoint

**File:** `app/api/fred/history/route.ts`

```typescript
// GET /api/fred/history
// Query params: limit, offset, sessionId, type
// Returns paginated list of conversations/decisions
```

### Step 2: Create Decision History Page

**File:** `app/dashboard/history/page.tsx`

Layout:
- Left sidebar: Session list (grouped by date)
- Main area: Selected session conversation
- Metadata panel: Decisions, outcomes, learned facts

### Step 3: Create Session List Component

**File:** `components/history/session-list.tsx`

Features:
- List of sessions grouped by date
- Preview of first message
- Badge showing decision count
- Search/filter capability

### Step 4: Create Conversation View Component

**File:** `components/history/conversation-view.tsx`

Features:
- Full conversation thread display
- Decision highlights with confidence
- Outcome status (if tracked)
- "Continue this conversation" button

### Step 5: Create Context Panel Component

**File:** `components/history/context-panel.tsx`

Shows:
- Facts FRED learned (semantic memory)
- Startup profile summary
- Key decisions and their status

### Step 6: Add History Link to Dashboard

**File:** `app/dashboard/page.tsx` (update)

Add card/link to access decision history

---

## Testing

- [x] History loads correctly
- [x] Sessions display in chronological order
- [x] Conversation view renders all messages
- [x] Context panel shows learned facts
- [x] Pagination works correctly

---

## Verification

- [x] History page accessible from dashboard
- [x] Sessions grouped and filterable
- [x] Full conversations viewable
- [x] Context/facts displayed
- [x] Empty state handled gracefully

---

## Implementation Summary

**Files Created:**
- `app/api/fred/history/route.ts` - History API endpoint with session grouping
- `components/history/session-list.tsx` - Session list with search and date grouping
- `components/history/conversation-view.tsx` - Full conversation display with decisions
- `app/dashboard/history/page.tsx` - History page with split-pane layout

**Features:**
- Sessions grouped by date (Today, Yesterday, This Week, etc.)
- Search functionality
- Continue conversation button
- Decision cards with confidence indicators
- Empty states for no data

---

*Plan completed: 2026-02-05*
