# Plan 10-03: Dependency Cleanup & Code Hygiene

**Phase:** 10 - Production Hardening & Launch Prep
**Priority:** P2 (Quality of life)
**Estimated Scope:** 4 files modified, 2 files deleted

---

## Objective

Remove unused dependencies, clean up environment variable templates, implement monitoring export stubs, and remove orphaned code identified in audits.

---

## Tasks

### Task 1: Remove Unused Clerk Dependencies

**File:** `package.json`

**Issue:** Project uses Supabase for auth but still has Clerk packages listed:
- `@clerk/nextjs`
- `@clerk/themes`
- Any other `@clerk/*` packages

**Action:**
1. Verify no code imports from `@clerk/*` (grep confirms)
2. Remove from `package.json` dependencies
3. Run `npm install` to update lockfile
4. Remove `CLERK_*` vars from `.env.example`

### Task 2: Clean Up .env.example

**File:** `.env.example`

**Issue:** Contains 15+ unused environment variables that confuse setup.

**Action:** Remove these unused vars:
- `AUTH_COOKIE_*` (4 vars) - not referenced
- `CLERK_*` (5 vars) - Clerk not used
- `DATABASE_URL` - superseded by Supabase config
- `JWT_ACCESS_TOKEN_EXPIRES_IN`, `JWT_REFRESH_TOKEN_EXPIRES_IN` - not used
- `LIVEKIT_HOST` - `LIVEKIT_URL` is used instead
- `PAGERDUTY_ROUTING_KEY`, `SLACK_WEBHOOK_URL` - not used in code

Add clear section headers and comments for remaining vars.

### Task 3: Implement Monitoring Export

**File:** `app/dashboard/monitoring/page.tsx` (lines 167-186)

**Issue:** `handleExportCSV()` and `handleExportJSON()` show `alert()` instead of real export. `handleFilterChange()` updates state but doesn't refetch.

**Action:**
1. Implement CSV export: serialize monitoring data to CSV, trigger download via Blob URL
2. Implement JSON export: serialize to JSON, trigger download via Blob URL
3. Wire filter change to refetch monitoring data from API

### Task 4: Remove Orphaned Routes & Stubs

**Files to delete:**
- `app/api/check-ins/route.ts` - orphaned, no consumers

**Files to fix:**
- `app/documents/new/page.tsx` - uses mock content, wire to real document creation or remove
- Fix PagerDuty fallback URL in `lib/notifications/pagerduty.ts:115` - replace `example.com` with proper fallback or throw

---

## Verification

- [ ] No `@clerk/*` imports in codebase (grep returns empty)
- [ ] `npm install` succeeds without Clerk packages
- [ ] `.env.example` only contains vars actually used in code
- [ ] Monitoring CSV export downloads valid CSV file
- [ ] Monitoring JSON export downloads valid JSON file
- [ ] No orphaned `/api/check-ins` route
- [ ] `npx tsc --noEmit` passes
- [ ] `npx vitest run` passes

---

## Dependencies

None - independent of 10-01 and 10-02.

---

*Plan created: 2026-02-06*
