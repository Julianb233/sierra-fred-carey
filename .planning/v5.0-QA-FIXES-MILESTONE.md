# v5.0 QA Fixes — Production Polish Milestone

**Created:** 2026-02-16
**Source:** Full platform Stagehand browser QA audit
**Overall Score:** 78% pass rate (35/45 pages passing)
**Goal:** Fix all 10 failing pages and 7 bugs to reach 100% pass rate

---

## Work Streams (Parallelizable)

These 5 streams have **zero file overlap** and can run simultaneously across 5 teams.

---

### Stream A: Dashboard Routing Fix
**Priority:** CRITICAL
**Estimated Scope:** 1-2 files
**Depends on:** Nothing

**Problem:** Multiple `/dashboard/*` sub-routes render the Settings page instead of their intended content. This suggests a catch-all or fallback route in the dashboard layout that intercepts failed child routes.

**Affected Pages:**
- `/dashboard/communities` → renders Settings (should show Communities list)
- `/dashboard/documents` → renders Settings (should show Document Repository)
- `/dashboard/coaching` → renders Settings (should show Coaching Sessions)

**Investigation Points:**
1. `app/dashboard/layout.tsx` — check for catch-all routing logic or error boundary that falls back to Settings
2. `app/dashboard/communities/page.tsx` — verify the page component exports correctly
3. `app/dashboard/documents/page.tsx` — verify the page component exports correctly
4. `app/dashboard/coaching/page.tsx` — verify the page component exports correctly
5. Check if these pages use dynamic imports that fail silently

**Acceptance Criteria:**
- [ ] `/dashboard/communities` renders the Communities list page (Phase 41)
- [ ] `/dashboard/documents` renders the Document Repository page (Phase 44)
- [ ] `/dashboard/coaching` renders the Coaching Sessions page (Phase 29)
- [ ] No other dashboard routes are affected by the fix
- [ ] Each page shows appropriate content or FeatureLock for Free tier users

---

### Stream B: Infinite Loading Spinner Fixes
**Priority:** CRITICAL
**Estimated Scope:** 4-6 files (API routes + page components)
**Depends on:** Nothing

**Problem:** Several pages show a permanent loading spinner because their data-fetching API calls fail or timeout, and there are no error boundaries or fallback states.

**Affected Pages:**
1. `/dashboard` (Home / Founder Command Center) — calls `/api/dashboard/command-center`
2. `/dashboard/strategy` — calls `/api/fred/strategy`
3. `/documents` — calls `/api/documents`
4. `/check-ins` — calls `/api/check-ins`

**Investigation Points:**
1. Check each API route for errors when user has no profile/onboarding data
2. Check each page component for missing error boundaries or loading state timeouts
3. Verify that API routes handle empty-data cases gracefully (return `[]` not 500)
4. Add React error boundaries around data-dependent sections

**Fix Pattern (for each page):**
```
1. API route: Return empty data (not error) when user has no records
2. Page component: Add error boundary with friendly empty state
3. Page component: Add timeout fallback (if loading > 5s, show empty state)
```

**Acceptance Criteria:**
- [ ] `/dashboard` renders Founder Command Center (even if data sections are empty)
- [ ] `/dashboard/strategy` renders Strategy page (empty state if no strategies)
- [ ] `/documents` renders Document list (empty state if no documents)
- [ ] `/check-ins` renders Check-ins list (empty state if no check-ins)
- [ ] No page shows an infinite spinner for longer than 5 seconds
- [ ] Each page shows a clear CTA for new users (e.g., "Start your first check-in")

---

### Stream C: Demo Page Auth Fix
**Priority:** HIGH
**Estimated Scope:** 2-3 files
**Depends on:** Nothing

**Problem:** `/demo/boardy` and `/demo/virtual-team` render the login form instead of their demo content. Server returns 200 but client-side JavaScript redirects to login after TierProvider's subscription check fails for unauthenticated users.

**Affected Pages:**
- `/demo/boardy` → renders login form (should show Boardy advisor matching demo)
- `/demo/virtual-team` → renders login form (should show Virtual Team demo)

**Root Cause:** The `TierProvider` (in `app/providers.tsx` or `lib/context/tier-context.tsx`) calls `/api/user/subscription` on mount. For unauthenticated users, this returns 401, and the error handling chain triggers a client-side redirect to login.

**Investigation Points:**
1. `lib/context/tier-context.tsx` — check `fetchTier()` error handling
2. `app/providers.tsx` — check if TierProvider wraps demo pages
3. `app/demo/boardy/page.tsx` — check for auth-dependent imports
4. `app/demo/virtual-team/page.tsx` — check for auth-dependent imports
5. Compare with `/demo/investor-lens/page.tsx` (which works correctly)

**Fix Options:**
- Option A: Make `/api/user/subscription` return 200 with FREE tier for unauthenticated users
- Option B: Wrap demo pages in a separate provider that doesn't call subscription API
- Option C: Add demo pages to a TierProvider skip list

**Acceptance Criteria:**
- [ ] `/demo/boardy` renders the Boardy demo for unauthenticated users
- [ ] `/demo/virtual-team` renders the Virtual Team demo for unauthenticated users
- [ ] Other demo pages (`/demo/investor-lens`, `/demo/pitch-deck`, `/demo/reality-lens`) still work
- [ ] Authenticated users can also access demo pages normally

---

### Stream D: Duplicate Logo UI Fix
**Priority:** HIGH
**Estimated Scope:** 1-2 files (layout/CSS)
**Depends on:** Nothing

**Problem:** A second Sahara logo appears overlapping the navigation bar on several pages, covering the "See It in Action" and "About" links.

**Affected Pages:**
- `/login` — duplicate logo visible in nav area
- `/chat` — duplicate logo visible in top-right corner
- `/demo/boardy` — duplicate logo visible
- `/demo/virtual-team` — duplicate logo visible

**Investigation Points:**
1. Check for nested layout components that each render a `<Header>` or `<Nav>` with a logo
2. `app/login/page.tsx` or `app/login/layout.tsx` — may render its own logo above the page logo
3. `app/chat/page.tsx` — has a "Talk to Fred" header that may include a logo
4. `components/layout/header.tsx` or similar — check if logo is rendered in both a global layout and a page-specific layout
5. Look for a second `<Image>` or `<svg>` element for the Sahara logo in the DOM

**Acceptance Criteria:**
- [ ] Only one Sahara logo is visible on `/login`
- [ ] Only one Sahara logo is visible on `/chat`
- [ ] Navigation links ("See It in Action", "About") are fully visible and clickable
- [ ] No layout shift or overlap on any page

---

### Stream E: Error State & Empty State Polish
**Priority:** HIGH
**Estimated Scope:** 3-4 files
**Depends on:** Stream B (can start in parallel, finalize after)

**Problem:** Several pages show raw "Failed to fetch" error messages instead of user-friendly empty states.

**Affected Pages:**
1. `/dashboard/next-steps` — red banner: "Failed to fetch next steps"
2. `/dashboard/settings` — notification channels: "Failed to fetch settings"

**Fix Pattern:**
```
Replace error banners with:
- Friendly empty state illustration
- Explanatory text (e.g., "Chat with FRED to generate your next steps")
- Clear CTA button (e.g., "Chat with FRED" or "Configure notifications")
```

**Additional Polish:**
3. `/dashboard/profile/snapshot` — "Profile not found" could be warmer (e.g., "Let's build your founder profile")
4. All pages with FeatureLock — verify copy is consistent ("Upgrade to Fundraising & Strategy")

**Acceptance Criteria:**
- [ ] No red error banners visible on any page for new users
- [ ] `/dashboard/next-steps` shows empty state with "Chat with FRED" CTA
- [ ] `/dashboard/settings` notification channels shows setup guide instead of error
- [ ] All empty states have clear CTAs that guide users to the right action

---

## Parallelization Map

```
TIME ──────────────────────────────────────────────►

Team 1: ████ Stream A (Dashboard Routing)     ████ Done
Team 2: ████████ Stream B (Loading Spinners)   ████ Done
Team 3: ████ Stream C (Demo Auth Fix)          ████ Done
Team 4: ██ Stream D (Duplicate Logo)           ██ Done
Team 5: ████ Stream E (Error States)           ████ Done
         ^                                      ^
    All start                              All finish
    together                               independently
```

All 5 streams can start simultaneously. Stream E can finalize after Stream B but start investigating in parallel.

---

## Verification Plan

After all streams complete, run full regression:

1. **Public pages** (10) — confirm no regressions
2. **Auth pages** (4) — confirm login logo fixed
3. **Demo pages** (5) — confirm boardy + virtual-team work
4. **Dashboard core** — confirm home loads, settings works, communities/documents/coaching render
5. **FRED features** — confirm strategy loads, chat still works
6. **Documents/Check-ins** — confirm both load with empty states
7. **Error states** — confirm no red error banners for new users
8. **Mobile** (Phase 46) — test at 375px, 768px breakpoints

**Target:** 45/45 pages passing (100%)

---

## Bug Reference

| ID | Severity | Stream | Page(s) | Issue |
|----|----------|--------|---------|-------|
| BUG-1 | CRITICAL | B | `/dashboard` | Home infinite spinner |
| BUG-2 | CRITICAL | A | `/dashboard/communities,documents,coaching` | Renders Settings page |
| BUG-3 | CRITICAL | B | `/dashboard/strategy`, `/documents`, `/check-ins` | Infinite spinner |
| BUG-4 | HIGH | D | `/login`, `/chat`, demos | Duplicate Sahara logo |
| BUG-5 | HIGH | C | `/demo/boardy`, `/demo/virtual-team` | Renders login page |
| BUG-6 | HIGH | E | `/dashboard/next-steps`, `/dashboard/settings` | "Failed to fetch" errors |
| BUG-7 | MEDIUM | — | localhost:3000 | Dev server 500 (separate process) |
